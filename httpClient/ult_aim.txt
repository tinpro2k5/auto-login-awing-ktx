

Trong log cá»§a báº¡n cÃ³ bÆ°á»›c nÃ y:

[REQ] document POST http://186.186.0.1/login
postData: username=...&password=11c0227a...&dst=http%3A%2F%2Fv1.awingconnect.vn%2FSuccess&popup=false
origin: http://v1.awingconnect.vn
referer: http://v1.awingconnect.vn/


ÄÃ¢y lÃ  CHAP login tháº­t sá»±

username cá»‘ Ä‘á»‹nh (voucher / account hotspot)

password khÃ´ng pháº£i password tÄ©nh

NÃ³ lÃ  CHAP response hash, Ä‘Æ°á»£c tÃ­nh tá»«:

chap_id

chap_challenge

secret thá»±c (password gá»‘c / voucher key)
âœ… VáºªN auto login HTTP-only Ä‘Æ°á»£c, nhÆ°ng pháº£i tá»± tÃ­nh CHAP hash má»—i láº§ns



VÃ¬ sao UI pháº£i cháº¡y JS trÆ°á»›c khi POST /login

Trong flow báº¡n sniff tháº¥y:

URL cÃ³ chap_id + chap_challenge

JS phÃ­a portal dÃ¹ng 2 giÃ¡ trá»‹ nÃ y Ä‘á»ƒ:

láº¥y secret (voucher/password)

tÃ­nh MD5(CHAP) â†’ rá»“i má»›i POST /login

ÄÃ¢y lÃ  chuáº©n MikroTik Hotspot CHAP.



CÃ´ng thá»©c CHAP (chuáº©n MikroTik)

CHAP response =

MD5( chap_id (1 byte) + password (string) + chap_challenge (bytes) )


chap_id: sá»‘ (0â€“255)

password: password gá»‘c (khÃ´ng pháº£i hash)

chap_challenge: chuá»—i bytes (báº¡n tháº¥y dáº¡ng \143\125\031... hoáº·c 143,125,031,...)

â¡ï¸ Output lÃ  hex string (32 kÃ½ tá»±)
â†’ chÃ­nh lÃ  cÃ¡i password= báº¡n tháº¥y trong POST.



ğŸ‘‰ ÄÃ¢y chÃ­nh lÃ  kiá»ƒu RouterOS/Hotspot style login POST (form-urlencoded). NghÄ©a lÃ  báº¡n khÃ´ng cáº§n má»Ÿ Chromium Ä‘á»ƒ click ná»¯a: chá»‰ cáº§n POST Ä‘Ãºng endpoint nÃ y (vÃ  giá»¯ cookie/redirect) lÃ  xong.

Thiáº¿t káº¿ HTTP-only client (Node) sáº½ nhÆ° tháº¿ nÃ y
A) Giá»¯ cookie jar (cá»±c quan trá»ng)

DÃ¹ng undici + tough-cookie hoáº·c axios + tough-cookie Ä‘á»ƒ giá»¯ cookie xuyÃªn request nhÆ° browser.

B) Flow máº«u (khÃ¡i quÃ¡t)
Flow HTTP-only CHAP auto login (chuáº©n, clean)

BÆ°á»›c 1 â€” GET login page

GET http://186.186.0.1/login


â†’ parse:

chap_id

chap_challenge

BÆ°á»›c 2 â€” TÃ­nh CHAP hash

chapHash = MD5(
  byte(chap_id) +
  passwordPlain +
  chapChallengeBytes
)


BÆ°á»›c 3 â€” POST login

POST http://186.186.0.1/login
Content-Type: application/x-www-form-urlencoded

username=awing15-15
&password=<chapHash>
&dst=http://v1.awingconnect.vn/Success
&popup=false


BÆ°á»›c 4 â€” Verify

probe http://neverssl.com/

hoáº·c GET http://186.186.0.1/status


link-advert: http://186.186.0.1/advert

ğŸ‘‰ NghÄ©a lÃ  thay vÃ¬ â€œphÃºt cuá»‘i load portalâ€, báº¡n cÃ³ thá»ƒ:

thá»­ GET má»™t endpoint nháº¹ ná»™i bá»™ (status/advert) Ä‘á»ƒ xem session-time-left/uptime cÃ²n khÃ´ng

náº¿u bá»‹ redirect vá» /login â†’ má»›i login





password = username

password Ä‘Æ°á»£c nhÃ©t inline trong HTML / JS / JSON

password Ä‘Æ°á»£c táº¡o theo rule Ä‘Æ¡n giáº£n (ghÃ©p chuá»—i, base64, háº±ng sá»‘â€¦)



Má»Ÿ DevTools â†’ Sources â†’ Ctrl+Shift+F, tÃ¬m cÃ¡c tá»«:

chap
challenge
md5
password
pwd
secret
login
hotspot